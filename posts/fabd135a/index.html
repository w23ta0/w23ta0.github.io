<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Kerberos安装和管理 - w23ta0's blog</title><meta name=author content="w23ta0"><meta name=description content="Kerberos 服务(kerberos官网)是一种通过网络提供安全验证处理的客户机/服务器体系结构。通过验证，可保证网络事务的发送者和接收者的身份真实。该服务还可以检验来回传递的数据的有效性（完整性），并在传输过程中对数据进行加密（保密性）。使用 Kerberos 服务，可以安全登录到其他计算机、执行命令、交换数据以及传输文件。此外，该服务还提供授权服务，这样，管理员便可限制对服务和计算机的访问。而且，作为 Kerberos 用户，您还可以控制其他用户对您帐户的访问。
"><meta name=keywords content='kerberos,krb5,kinit,kdc'><meta itemprop=name content="Kerberos安装和管理"><meta itemprop=description content="Kerberos 服务(kerberos官网)是一种通过网络提供安全验证处理的客户机/服务器体系结构。通过验证，可保证网络事务的发送者和接收者的身份真实。该服务还可以检验来回传递的数据的有效性（完整性），并在传输过程中对数据进行加密（保密性）。使用 Kerberos 服务，可以安全登录到其他计算机、执行命令、交换数据以及传输文件。此外，该服务还提供授权服务，这样，管理员便可限制对服务和计算机的访问。而且，作为 Kerberos 用户，您还可以控制其他用户对您帐户的访问。"><meta itemprop=datePublished content="2017-09-25T17:31:54+00:00"><meta itemprop=dateModified content="2026-01-04T02:27:45+00:00"><meta itemprop=wordCount content="2776"><meta itemprop=keywords content="Kerberos,Krb5,Kinit,Kdc"><meta property="og:url" content="https://w23ta0.github.io/posts/fabd135a/"><meta property="og:site_name" content="w23ta0's blog"><meta property="og:title" content="Kerberos安装和管理"><meta property="og:description" content="Kerberos 服务(kerberos官网)是一种通过网络提供安全验证处理的客户机/服务器体系结构。通过验证，可保证网络事务的发送者和接收者的身份真实。该服务还可以检验来回传递的数据的有效性（完整性），并在传输过程中对数据进行加密（保密性）。使用 Kerberos 服务，可以安全登录到其他计算机、执行命令、交换数据以及传输文件。此外，该服务还提供授权服务，这样，管理员便可限制对服务和计算机的访问。而且，作为 Kerberos 用户，您还可以控制其他用户对您帐户的访问。"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-09-25T17:31:54+00:00"><meta property="article:modified_time" content="2026-01-04T02:27:45+00:00"><meta property="article:tag" content="Kerberos"><meta property="article:tag" content="Krb5"><meta property="article:tag" content="Kinit"><meta property="article:tag" content="Kdc"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kerberos安装和管理"><meta name=twitter:description content="Kerberos 服务(kerberos官网)是一种通过网络提供安全验证处理的客户机/服务器体系结构。通过验证，可保证网络事务的发送者和接收者的身份真实。该服务还可以检验来回传递的数据的有效性（完整性），并在传输过程中对数据进行加密（保密性）。使用 Kerberos 服务，可以安全登录到其他计算机、执行命令、交换数据以及传输文件。此外，该服务还提供授权服务，这样，管理员便可限制对服务和计算机的访问。而且，作为 Kerberos 用户，您还可以控制其他用户对您帐户的访问。"><meta name=application-name content="w23ta0's blog"><meta name=apple-mobile-web-app-title content="w23ta0's blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=images/happy.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://w23ta0.github.io/posts/fabd135a/ title="Kerberos安装和管理 - w23ta0's blog"><link rel=prev type=text/html href=https://w23ta0.github.io/posts/1ad460a4/ title="解决LDAP出现ldap_bind: Invalid credentials (49)错误"><link rel=next type=text/html href=https://w23ta0.github.io/posts/3bf7d2bc/ title="Docker私有仓库pull镜像报错：server gave HTTP response to HTTPS client"><link rel=alternate type=text/markdown href=https://w23ta0.github.io/posts/fabd135a/index.md title="Kerberos安装和管理 - w23ta0's blog"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="mfpXQWYjakmUHCSG3MJxk8SDfQ2oLcOgJ3a0YQ9kycw"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Kerberos安装和管理","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/w23ta0.github.io\/posts\/fabd135a\/"},"genre":"posts","keywords":"kerberos, krb5, kinit, kdc","wordcount":2776,"url":"https:\/\/w23ta0.github.io\/posts\/fabd135a\/","datePublished":"2017-09-25T17:31:54+00:00","dateModified":"2026-01-04T02:27:45+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"w23ta0"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="w23ta0's blog"><img class=logo src=/images/happy.png alt="w23ta0's blog" height=32 width=32><span class=header-title-text>w23ta0's blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/index.xml><i class="fa-solid fa-rss fa-fw fa-sm" aria-hidden=true></i> RSS</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-quote-left fa-fw fa-sm" aria-hidden=true></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="w23ta0's blog"><img class=logo src=/images/happy.png alt="w23ta0's blog" height=26 width=26><span class=header-title-text>w23ta0's blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/index.xml><i class="fa-solid fa-rss fa-fw fa-sm" aria-hidden=true></i> RSS</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-quote-left fa-fw fa-sm" aria-hidden=true></i> About</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=Collections></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Kerberos安装和管理</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/w23ta0 title=Author target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src='https://www.gravatar.com/avatar/c8ec6802a4a65963e20a021760ec27f0?s=32&d=' alt=w23ta0 height=16 width=16>&nbsp;w23ta0</a></span><span class=post-included-in>&nbsp;included in <a href=/categories/%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81/ class=post-category title="Category - 身份认证"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 身份认证</a>&ensp;<a href=/categories/kerberos/ class=post-category title="Category - Kerberos"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Kerberos</a></span></div><div class=post-meta-line><span title="published on 2017-09-25 17:31:54"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2017-09-25>2017-09-25</time></span>&nbsp;<span title="Updated on 2026-01-04 02:27:45"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2026-01-04>2026-01-04</time></span>&nbsp;<span title="2776 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>About 2800 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>6 minutes</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=Kerberos安装和管理><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;views
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#kerberos原理>Kerberos原理</a><ul><li><a href=#获取原始票据>获取原始票据</a></li><li><a href=#获取服务票据以及访问服务>获取服务票据以及访问服务</a></li></ul></li><li><a href=#安装kerberos>安装Kerberos</a><ul><li><a href=#安装package>安装package</a></li><li><a href=#配置dns>配置DNS</a></li><li><a href=#配置etckrb5conf使其指定到正确的realm中>配置/etc/krb5.conf,使其指定到正确的realm中</a></li><li><a href=#创建kdc配置文件>创建KDC配置文件</a></li><li><a href=#配置acl文件>配置acl文件</a></li><li><a href=#使用kdb5_util创建kdc数据库>使用kdb5_util创建kdc数据库</a></li><li><a href=#启动服务>启动服务</a></li><li><a href=#验证principle>验证principle</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>Kerberos 服务(<a href=http://web.mit.edu/kerberos/ target=_blank rel="external nofollow noopener noreferrer">kerberos官网</a>)是一种通过网络提供安全验证处理的客户机/服务器体系结构。通过验证，可保证网络事务的发送者和接收者的身份真实。该服务还可以检验来回传递的数据的有效性（完整性），并在传输过程中对数据进行加密（保密性）。使用 Kerberos 服务，可以安全登录到其他计算机、执行命令、交换数据以及传输文件。此外，该服务还提供授权服务，这样，管理员便可限制对服务和计算机的访问。而且，作为 Kerberos 用户，您还可以控制其他用户对您帐户的访问。</p><h2 class=heading-element id=kerberos原理><span>Kerberos原理</span>
<a href=#kerberos%e5%8e%9f%e7%90%86 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>Kerberos 服务是单点登录系统，这意味着您对于每个会话只需向服务进行一次自我验证，即可自动保护该会话过程中所有后续事务的安全。服务对您进行验证后，即无需在每次使用基于 Kerberos 的服务时进行验证。因此，无需在每次使用这些服务时都在网络上发送口令（增强了安全性）。MIT写了一段故事型的对话，比较生动得表述了Kerberos协议的工作原理：
Athena和欧里庇得斯关于地狱之门守护者的对话。简而言之，kerbores V5的工作原理如下：
Kerbores中有三种角色：
<code>KDC</code>：负责分发密钥的密钥分配中心
<code>Client</code>：需要使用kerbores服务的客户端
<code>Service</code>：提供具体服务的服务端
其中，Client需要和KDC和Service都进行通信。协议授权流程分两个部分：</p><h3 class=heading-element id=获取原始票据><span>获取原始票据</span>
<a href=#%e8%8e%b7%e5%8f%96%e5%8e%9f%e5%a7%8b%e7%a5%a8%e6%8d%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>首先，Client向KDC发送自己的身份信息，KDC从授予票据服务(Ticket Granting Service)得到可用的票据(ticket-granting ticket)，并用协议开始前KDC与Client之间的密钥将票据加密回复给client，client收到KDC回复的加密票据后利用与client先前协议的密钥将票据解密，从而获得票据，此步骤主要是允许client进行Kerberos的验证，是进行访问服务的先决条件。</p><h3 class=heading-element id=获取服务票据以及访问服务><span>获取服务票据以及访问服务</span>
<a href=#%e8%8e%b7%e5%8f%96%e6%9c%8d%e5%8a%a1%e7%a5%a8%e6%8d%ae%e4%bb%a5%e5%8f%8a%e8%ae%bf%e9%97%ae%e6%9c%8d%e5%8a%a1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>client利用之前获得的票据向KDC请求服务票据，从而通过服务的身份验证。获取服务票据以及访问服务总共有如下四步：</p><ol><li><p>client将之前获得的票据和要请求的服务信息发送给KDC，KDC中的授予票据服务将client和service之间生成一个会话密钥(Session Key)用于服务器与client的身份验证。然后KDC将这个会话密钥和用户名，用户地址(IP)，服务名，有效期，时间戳一起包装成一个票据(这张票据用于service对client的身份验证)通过client转发给service。</p></li><li><p>为了让票据对client保密，所以KDC用协议开始之前KDC与服务端之间的密钥将票据加密后再发给client，同时为了让client与service之间共享那个会话密钥，KDC用client与它之间的密钥将会话密钥加密返回给client</p></li><li><p>为了完成票据的传递，client将刚才收到的票据转发到service，由于client不知道KDC与service的密钥，所以它无法修改票据的信息，同时client将收到的会话密钥解压出来，然后将自己的用户名，用户地址(IP)打包成验证包用会话密钥加密也发给service</p></li><li><p>Service收到票据后利用它与KDC之间的密钥将票据中的信息解密出来，从而获得会话密钥和用户名，用户地址(IP)，服务名，有效期。然后再用会话密钥将验证包解密从而获得用户名，用户地址(IP)将其与之前票据中解密出来的用户名，用户地址(IP)做比较从而验证client的身份，如果service有返回结果，将其返回给client</p></li></ol><h2 class=heading-element id=安装kerberos><span>安装Kerberos</span>
<a href=#%e5%ae%89%e8%a3%85kerberos class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=安装package><span>安装package</span>
<a href=#%e5%ae%89%e8%a3%85package class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>在CentOS中可以使用yum来安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install -y krb5-libs krb5-server krb5-client</span></span></code></pre></td></tr></table></div></div><p>或者使用源代码构建:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget http://web.mit.edu/kerberos/dist/krb5/1.12/krb5-1.12.2-signed.tar
</span></span><span class=line><span class=cl>tar xvf krb5-1.12.2-signed.tar <span class=o>&amp;&amp;</span> tar xvzf krb5-1.12.2.tar.gz
</span></span><span class=line><span class=cl><span class=nb>cd</span> krb5-1.12.2/src
</span></span><span class=line><span class=cl>./configure
</span></span><span class=line><span class=cl>yum install -y byacc
</span></span><span class=line><span class=cl>make -j <span class=o>&amp;&amp;</span> make install</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=配置dns><span>配置DNS</span>
<a href=#%e9%85%8d%e7%bd%aedns class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>使用dnsmasq配置一个简单的本地DNS，保证需要解析的主机名在/etc/hosts中。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install -y dnsmasq
</span></span><span class=line><span class=cl>vim /etc/dnsmasq.conf
</span></span><span class=line><span class=cl><span class=nv>domain</span><span class=o>=</span>expmale.com
</span></span><span class=line><span class=cl><span class=nv>local</span><span class=o>=</span>/expmale.com/
</span></span><span class=line><span class=cl>expand-hosts
</span></span><span class=line><span class=cl>no-resolv
</span></span><span class=line><span class=cl>cache-size<span class=o>=</span><span class=m>500</span>
</span></span><span class=line><span class=cl>log-queries
</span></span><span class=line><span class=cl>service dnsmasq start
</span></span><span class=line><span class=cl>Starting dnsmasq:                                          <span class=o>[</span>  OK  <span class=o>]</span></span></span></code></pre></td></tr></table></div></div><p>设置客户端DNS Server
修改网卡配置文件或/etc/resolv.conf
DNS1=192.168.1.221
检查域名解析</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nslookup kerberos.expmale.com
</span></span><span class=line><span class=cl>Server:		192.168.1.221
</span></span><span class=line><span class=cl>Address:	192.168.1.221#53
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Name:	kerberos.expmale.com
</span></span><span class=line><span class=cl>Address: 192.168.1.221</span></span></code></pre></td></tr></table></div></div><p>这样DNS已经OK。</p><h3 class=heading-element id=配置etckrb5conf使其指定到正确的realm中><span>配置/etc/krb5.conf,使其指定到正确的realm中</span>
<a href=#%e9%85%8d%e7%bd%aeetckrb5conf%e4%bd%bf%e5%85%b6%e6%8c%87%e5%ae%9a%e5%88%b0%e6%ad%a3%e7%a1%ae%e7%9a%84realm%e4%b8%ad class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>logging<span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=nv>default</span> <span class=o>=</span> FILE:/var/log/krb5libs.log
</span></span><span class=line><span class=cl> <span class=nv>kdc</span> <span class=o>=</span> FILE:/var/log/krb5kdc.log
</span></span><span class=line><span class=cl> <span class=nv>admin_server</span> <span class=o>=</span> FILE:/var/log/kadmind.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>libdefaults<span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=nv>default_realm</span> <span class=o>=</span> EXPMALE.COM
</span></span><span class=line><span class=cl> <span class=nv>dns_lookup_realm</span> <span class=o>=</span> <span class=nb>false</span>
</span></span><span class=line><span class=cl> <span class=nv>dns_lookup_kdc</span> <span class=o>=</span> <span class=nb>false</span>
</span></span><span class=line><span class=cl> <span class=nv>ticket_lifetime</span> <span class=o>=</span> 24h
</span></span><span class=line><span class=cl> <span class=nv>renew_lifetime</span> <span class=o>=</span> 7d
</span></span><span class=line><span class=cl> <span class=nv>forwardable</span> <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>realms<span class=o>]</span>
</span></span><span class=line><span class=cl> EXPMALE.COM <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>kdc</span> <span class=o>=</span> kerberos.expmale.com
</span></span><span class=line><span class=cl>  <span class=nv>admin_server</span> <span class=o>=</span> kerberos.expmale.com
</span></span><span class=line><span class=cl> <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>domain_realm<span class=o>]</span>
</span></span><span class=line><span class=cl> .expmale.com <span class=o>=</span> EXPMALE.COM
</span></span><span class=line><span class=cl> expmale.com <span class=o>=</span> EXPMALE.COM</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=创建kdc配置文件><span>创建KDC配置文件</span>
<a href=#%e5%88%9b%e5%bb%bakdc%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim /var/kerberos/krb5kdc/kdc.conf
</span></span><span class=line><span class=cl><span class=o>[</span>kdcdefaults<span class=o>]</span>
</span></span><span class=line><span class=cl> <span class=nv>kdc_ports</span> <span class=o>=</span> <span class=m>88</span>
</span></span><span class=line><span class=cl> <span class=nv>kdc_tcp_ports</span> <span class=o>=</span> <span class=m>88</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>realms<span class=o>]</span>
</span></span><span class=line><span class=cl> EXPMALE.COM <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>#master_key_type = aes256-cts</span>
</span></span><span class=line><span class=cl>  <span class=nv>acl_file</span> <span class=o>=</span> /var/kerberos/krb5kdc/kadm5.acl
</span></span><span class=line><span class=cl>  <span class=nv>dict_file</span> <span class=o>=</span> /usr/share/dict/words
</span></span><span class=line><span class=cl>  <span class=nv>admin_keytab</span> <span class=o>=</span> /var/kerberos/krb5kdc/kadm5.keytab
</span></span><span class=line><span class=cl>  <span class=nv>supported_enctypes</span> <span class=o>=</span> aes256-cts:normal aes128-cts:normal des3-hmac-sha1:normal arcfour-hmac:normal des-hmac-sha1:normal des-cbc-md5:normal des-cbc-crc:normal
</span></span><span class=line><span class=cl> <span class=o>}</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=配置acl文件><span>配置acl文件</span>
<a href=#%e9%85%8d%e7%bd%aeacl%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim /var/kerberos/krb5kdc/kadm5.acl 
</span></span><span class=line><span class=cl>*/admin@EXPMALE.COM        *</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=使用kdb5_util创建kdc数据库><span>使用kdb5_util创建kdc数据库</span>
<a href=#%e4%bd%bf%e7%94%a8kdb5_util%e5%88%9b%e5%bb%bakdc%e6%95%b0%e6%8d%ae%e5%ba%93 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kdb5_util create -r EXPMALE.COM -s
</span></span><span class=line><span class=cl>Loading random data
</span></span><span class=line><span class=cl>Initializing database <span class=s1>&#39;/usr/local/var/krb5kdc/principal&#39;</span> <span class=k>for</span> realm <span class=s1>&#39;EXPMALE.COM&#39;</span>,
</span></span><span class=line><span class=cl>master key name <span class=s1>&#39;K/M@EXPMALE.COM&#39;</span>
</span></span><span class=line><span class=cl>You will be prompted <span class=k>for</span> the database Master Password.
</span></span><span class=line><span class=cl>It is important that you NOT FORGET this password.
</span></span><span class=line><span class=cl>Enter KDC database master key: 
</span></span><span class=line><span class=cl>Re-enter KDC database master key to verify: </span></span></code></pre></td></tr></table></div></div><div class="note warning"><p>出现 Loading random data 的时候另开个终端执行点消耗CPU的命令如 cat /dev/sda > /dev/urandom 可以加快随机数采集。</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kadmin.local 
</span></span><span class=line><span class=cl>Authenticating as principal root/admin@EXPMALE.COM with password.</span></span></code></pre></td></tr></table></div></div><p>首先有介绍一个术语（参考<a href=http://wgzhao.com/2005/12/02/kerberos-authentication-configuration/ target=_blank rel="external nofollow noopener noreferrer">kerberos 认证配置</a>）：</p><ul><li><p><strong>Principal</strong>：在 Kerberos 中，Principal 是参加认证的基本实体。一般来说有两种，一种用来表示 Kerberos 数据库中的用户，另一种用来代表某一特定主机，也就是说 Principal是用来表示客户端和服务端身份的实体, Principal 的格式采用 ASN.1 标准,即 Abstract Syntax Notation One，来准确定义)，Principal 是由三个部分组成：名字（name），实例（instance），REALM（域）。比如一个标准的 Kerberos 的用户是：name/instance@REALM 。</p></li><li><p><strong>Name</strong>：第一部分。在代表客户方的情况，它是一个用户名；在代表主机的情况，它是写成 host。</p></li><li><p><strong>Instance</strong>：第二部分。对 name 的进一步描述，例如 name 所在的主机名或 name 的类型等,可省略。它与第一部分之间用‘ / ’分隔，但是作为主机的描述时写成 host/Instance。</p></li><li><p><strong>Realm</strong>：第三部分。是 Kerberos 在管理上的划分，在 KDC 中所负责的一个域数据库称作为 Realm。这个数据库中存放有该网络范围内的所有 Principal 和它们的密钥，数据库的内容被 Kerberos 的认证服务器 AS 和票据授权服务器 TGS 所使用。Realm 通常是永远是大写的字符,并且在大多数 Kerberos 系统的配置中，一般 Realm 和该网络环境的 DNS 域是一致的。与第二部分之间用‘@’分隔，缺省为本地的 Realm。</p></li></ul><p>添加新的管理员用户，kadmin和kadmin.local是KDC的管理接口。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 添加新的管理员用户</span>
</span></span><span class=line><span class=cl>kadmin.local:  addprinc single/admin
</span></span><span class=line><span class=cl>WARNING: no policy specified <span class=k>for</span> single/admin@EXPMALE.COM<span class=p>;</span> defaulting to no policy
</span></span><span class=line><span class=cl>Enter password <span class=k>for</span> principal <span class=s2>&#34;single/admin@EXPMALE.COM&#34;</span>: 
</span></span><span class=line><span class=cl>Re-enter password <span class=k>for</span> principal <span class=s2>&#34;single/admin@EXPMALE.COM&#34;</span>: 
</span></span><span class=line><span class=cl>Principal <span class=s2>&#34;single/admin@EXPMALE.COM&#34;</span> created.
</span></span><span class=line><span class=cl><span class=c1># 列出所有的principle</span>
</span></span><span class=line><span class=cl>kadmin.local:  listprincs
</span></span><span class=line><span class=cl>K/M@EXPMALE.COM
</span></span><span class=line><span class=cl>single/admin@EXPMALE.COM
</span></span><span class=line><span class=cl>kadmin/admin@EXPMALE.COM
</span></span><span class=line><span class=cl>kadmin/cdh_manager@EXPMALE.COM
</span></span><span class=line><span class=cl>kadmin/changepw@EXPMALE.COM
</span></span><span class=line><span class=cl>krbtgt/EXPMALE.COM@EXPMALE.COM
</span></span><span class=line><span class=cl><span class=c1># 查看principle：</span>
</span></span><span class=line><span class=cl>getprinc single/admin@EXPMALE.COM
</span></span><span class=line><span class=cl><span class=c1># 删除principle：</span>
</span></span><span class=line><span class=cl>delprinc single/admin@EXPMALE.COM
</span></span><span class=line><span class=cl><span class=c1># 修改principle密码：</span>
</span></span><span class=line><span class=cl>cpw -pw password test1/admin@EXPMALE.COM</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=启动服务><span>启动服务</span>
<a href=#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>service krb5kdc restart
</span></span><span class=line><span class=cl>Starting Kerberos <span class=m>5</span> KDC:                         <span class=o>[</span>  OK  <span class=o>]</span>
</span></span><span class=line><span class=cl>service kadmin restart
</span></span><span class=line><span class=cl>Starting Kerberos <span class=m>5</span> Admin Server:                <span class=o>[</span>  OK  <span class=o>]</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=验证principle><span>验证principle</span>
<a href=#%e9%aa%8c%e8%af%81principle class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>在其他主机上需要有相同的krb5.conf配置。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#登录验证</span>
</span></span><span class=line><span class=cl>kinit test1/hadoop01@EXPMALE.COM
</span></span><span class=line><span class=cl>Password <span class=k>for</span> test1/hadoop01@EXPMALE.COM: 
</span></span><span class=line><span class=cl><span class=c1>#查看凭证</span>
</span></span><span class=line><span class=cl>klist
</span></span><span class=line><span class=cl>Ticket cache: FILE:/tmp/krb5cc_0
</span></span><span class=line><span class=cl>Default principal: test1/hadoop01@EXPMALE.COM
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Valid starting     Expires            Service principalna jiu
</span></span><span class=line><span class=cl>/08/14 11:58:00  09/09/14 11:58:00  krbtgt/EXPMALE.COM@EXPMALE.COM
</span></span><span class=line><span class=cl>	renew <span class=k>until</span> 09/08/14 11:58:00
</span></span><span class=line><span class=cl><span class=c1>#注销凭证</span>
</span></span><span class=line><span class=cl>kdestory</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Updated on 2026-01-04 02:27:45">Updated on 2026-01-04&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/fabd135a/index.md title="Read Markdown" class=link-to-markdown>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on X" data-sharer=twitter data-url=https://w23ta0.github.io/posts/fabd135a/ data-title=Kerberos安装和管理 data-hashtags=kerberos,krb5,kinit,kdc><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://w23ta0.github.io/posts/fabd135a/ data-hashtag=kerberos><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://w23ta0.github.io/posts/fabd135a/ data-title=Kerberos安装和管理><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/kerberos/ class=post-tag title="Tags - Kerberos">Kerberos</a><a href=/tags/krb5/ class=post-tag title="Tags - Krb5">Krb5</a><a href=/tags/kinit/ class=post-tag title="Tags - Kinit">Kinit</a><a href=/tags/kdc/ class=post-tag title="Tags - Kdc">Kdc</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/1ad460a4/ class=post-nav-item rel=prev title="解决LDAP出现ldap_bind: Invalid Credentials (49)错误"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>解决LDAP出现ldap_bind: Invalid Credentials (49)错误</a><a href=/posts/3bf7d2bc/ class=post-nav-item rel=next title="Docker私有仓库pull镜像报错：server Gave HTTP Response to HTTPS Client">Docker私有仓库pull镜像报错：server Gave HTTP Response to HTTPS Client<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=w23ta0/w23ta0.github.io data-repo-id=R_kgDOOErTJA data-category=Announcements data-category-id=DIC_kwDOOErTJM4CnrNF data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=Contents><h2 class=toc-title>Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered">Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.154.2"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Theme - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.20"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2012 - 2026</span><span class=author itemprop=copyrightHolder>
<a href=https://github.com/w23ta0 target=_blank rel="external nofollow noopener noreferrer">w23ta0</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title='Total visitors'><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title='Total visits'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label="View Comments"><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>This website works best with JavaScript enabled.</div></noscript></div><link rel=preload href=/lib/katex/katex.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/katex/katex.min.css></noscript><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/js/flyfish.min.js defer></script><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=https://vercount.one/js async defer></script><script>window.config={code:{copyTitle:"Copy to clipboard",editLockTitle:"Lock editable code block",editUnLockTitle:"Unlock editable code block",editable:!0,maxShownLines:10},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark",lightTheme:"light",origin:"https://giscus.app"}},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/search.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"No results found",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},version:"v0.3.20"}</script><script src=/js/theme.min.js defer></script><script src=/js/custom.min.js defer></script></body></html>